<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة تحليل نقاط الألم الخفية</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --border-radius: 10px;
            --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Noto Sans Arabic', Tahoma, sans-serif;
        }
        
        body {
            background-color: #f8f9fa;
            color: #333;
            line-height: 1.6;
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
        }
        
        @media (min-width: 992px) {
            .main-container {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card-title {
            font-size: 1.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card-title i {
            color: var(--secondary-color);
        }
        
        .counter-list {
            list-style: none;
            margin-bottom: 20px;
        }
        
        .counter-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 10px;
            background-color: var(--light-color);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .counter-item:hover {
            background-color: #e0e7ed;
        }
        
        .counter-name {
            font-weight: bold;
        }
        
        .counter-intensity {
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
        }
        
        .high-intensity {
            background-color: var(--accent-color);
        }
        
        .medium-intensity {
            background-color: var(--warning-color);
        }
        
        .low-intensity {
            background-color: var(--success-color);
        }
        
        .time-chart-container {
            height: 300px;
            margin-top: 20px;
        }
        
        .impact-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .impact-item {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .impact-label {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .impact-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        .improvement {
            color: var(--success-color);
        }
        
        .decline {
            color: var(--accent-color);
        }
        
        .training-comparison {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }
        
        .training-type {
            text-align: center;
            padding: 15px;
            flex: 1;
            margin: 0 10px;
            border-radius: 8px;
            background-color: var(--light-color);
        }
        
        .training-type h4 {
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .training-score {
            font-size: 2rem;
            font-weight: bold;
            color: var(--secondary-color);
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            background-color: var(--secondary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: #2980b9;
            transform: translateY(-3px);
        }
        
        .btn-export {
            background-color: var(--success-color);
        }
        
        .btn-export:hover {
            background-color: #219653;
        }
        
        .btn-refresh {
            background-color: var(--primary-color);
        }
        
        .btn-refresh:hover {
            background-color: #1a252f;
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #ddd;
            color: #666;
            font-size: 0.9rem;
        }
        
        .highlight {
            color: var(--accent-color);
            font-weight: bold;
        }
        
        .insight-box {
            background-color: #e8f4fc;
            border-right: 5px solid var(--secondary-color);
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 8px 8px 0;
        }
        
        .insight-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: var(--primary-color);
        }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-chart-line"></i>
            تحويل نقاط الألم غير المرئية
        </h1>
        <p class="subtitle">
تحويل نقاط الألم غير المرئية إلى مؤشرات واضحة قابلة للقياس، مما يساعد على فهم السلوكيات، تحديد أماكن الازدحام، وتحسين التجربة التشغيلية.        </p>
    </header>
    
    <main class="main-container">
        <!-- العدادات ذات أعلى شدة سلوك -->
        <section class="card">
            <h2 class="card-title"><i class="fas fa-sort-amount-down"></i>
العدادات الأعلى في شدة السلوك                </h2>
            <ul class="counter-list" id="countersList">
                <!-- سيتم ملؤها بواسطة JavaScript -->
            </ul>
            <div class="insight-box">
                <div class="insight-title">رؤية تحليلية:</div>
                <p>عداد <span class="highlight">المدخل الرئيسي</span> يسجل أعلى شدة سلوك مما يشير إلى احتمال وجود ازدحام عند نقطة الدخول. هذا يتطلب مراجعة تصميم المدخل أو إضافة مسارات دخول بديلة.</p>
            </div>
        </section>
        
        <!-- ساعات الذروة والعمل -->
        <section class="card">
            <h2 class="card-title"><i class="fas fa-clock"></i>
ساعات الذروة والأنماط الزمنية
                </h2>
            <div class="time-chart-container">
                <canvas id="hourlyChart"></canvas>
            </div>
            <div class="insight-box">
                <div class="insight-title">رؤية تحليلية:</div>
                <p>تُسجَّل أعلى مستويات النشاط <span class="highlight">الساعة 10 صباحًا والساعة 4 عصرًا</span>. يمكن تخفيف الازدحام خلال هذه الفترات عن طريق توزيع المواعيد أو إضافة موظفين إضافيين.</p>
            </div>
        </section>
        
        <!-- تأثير التغييرات -->
        <section class="card">
            <h2 class="card-title"><i class="fas fa-exchange-alt"></i> تأثير تغييرات اللافتات/التخطيط/السياسات</h2>
            <div class="impact-container" id="impactContainer">
                <!-- سيتم ملؤها بواسطة JavaScript -->
            </div>
            <div class="insight-box">
                <div class="insight-title">رؤية تحليلية:</div>
                <p>تغييرات <span class="highlight">اللافتات الإرشادية</span> أدت إلى أكبر تحسن في تدفق المراجعين بنسبة 32%. يمكن تعميم هذا النجاح على مناطق أخرى.</p>
            </div>
        </section>
        
        <!-- الفروق في تدريب الضباط -->
        <section class="card">
            <h2 class="card-title"><i class="fas fa-user-graduate"></i> الفروق في تدريب الضباط/الموظفين</h2>
            <div class="training-comparison" id="trainingComparison">
                <!-- سيتم ملؤها بواسطة JavaScript -->
            </div>
            <div class="insight-box">
                <div class="insight-title">رؤية تحليلية:</div>
                <p>الموظفون الذين تلقوا <span class="highlight">التدريب المتقدم</span> حققوا نتائج أفضل بنسبة 28% في معالجة المراجعين. يقترح توسيع نطاق هذا التدريب ليشمل جميع الموظفين.</p>
            </div>
        </section>
    </main>
    
    <div class="controls">
        <button class="btn btn-refresh" id="refreshBtn">
            <i class="fas fa-sync-alt"></i> تحديث البيانات
        </button>
        <button class="btn btn-export" id="exportBtn">
            <i class="fas fa-file-export"></i> تصدير التقرير
        </button>
    </div>
    
    <footer>
        <p>© 2023 نظام تحليل نقاط الألم الخفية. تم تصميم هذه اللوحة لجعل المشاكل غير المرئية مرئية وقابلة للحل.</p>
        <p>جميع البيانات معروضة لأغراض تحليلية وتحتاج إلى تفسير من قبل المختصين.</p>
    </footer>

    <script>
        // بيانات العدادات وشدة السلوك
        const counters = [
            { name: "المدخل الرئيسي", intensity: 95 },
            { name: "عداد الخدمة السريعة", intensity: 87 },
            { name: "عداد الاستعلامات", intensity: 78 },
            { name: "عداد الدفع النقدي", intensity: 72 },
            { name: "عداد الخدمات الخاصة", intensity: 65 },
            { name: "عداد الشباك الخارجي", intensity: 58 }
        ];
        
        // بيانات ساعات الذروة
        const hourlyData = {
            labels: ["8 ص", "9 ص", "10 ص", "11 ص", "12 م", "1 م", "2 م", "3 م", "4 م", "5 م"],
            values: [65, 78, 92, 85, 72, 68, 74, 81, 94, 76]
        };
        
        // بيانات تأثير التغييرات
        const impacts = [
            { label: "تغييرات اللافتات الإرشادية", value: "+32%", type: "improvement" },
            { label: "إعادة تخطيط منطقة الانتظار", value: "+18%", type: "improvement" },
            { label: "سياسة الخدمة بالأسبقية", value: "+24%", type: "improvement" },
            { label: "تغيير موقع العدادات", value: "-5%", type: "decline" }
        ];
        
        // بيانات تدريب الضباط
        const trainingData = [
            { type: "التدريب الأساسي", score: 72 },
            { type: "التدريب المتقدم", score: 92 },
            { type: "التدريب المتخصص", score: 85 }
        ];
        
        // تهيئة العناصر عند تحميل الصفحة
        document.addEventListener('DOMContentLoaded', function() {
            renderCounters();
            renderHourlyChart();
            renderImpacts();
            renderTrainingComparison();
            
            // إضافة التفاعلية للأزرار
            document.getElementById('refreshBtn').addEventListener('click', refreshData);
            document.getElementById('exportBtn').addEventListener('click', exportReport);
        });
        
        // عرض العدادات ذات أعلى شدة سلوك
        function renderCounters() {
            const countersList = document.getElementById('countersList');
            countersList.innerHTML = '';
            
            // ترتيب العدادات تنازلياً حسب الشدة
            counters.sort((a, b) => b.intensity - a.intensity);
            
            counters.forEach(counter => {
                const li = document.createElement('li');
                li.className = 'counter-item';
                
                // تحديد مستوى الشدة
                let intensityClass = 'low-intensity';
                if (counter.intensity >= 80) intensityClass = 'high-intensity';
                else if (counter.intensity >= 70) intensityClass = 'medium-intensity';
                
                li.innerHTML = `
                    <span class="counter-name">${counter.name}</span>
                    <span class="counter-intensity ${intensityClass}">${counter.intensity}%</span>
                `;
                
                countersList.appendChild(li);
            });
        }
        
        // رسم مخطط ساعات الذروة
        function renderHourlyChart() {
            const ctx = document.getElementById('hourlyChart').getContext('2d');
            
            // تحديد الألوان بناءً على القيمة
            const backgroundColors = hourlyData.values.map(value => {
                if (value >= 90) return 'rgba(231, 76, 60, 0.7)';
                if (value >= 80) return 'rgba(243, 156, 18, 0.7)';
                return 'rgba(52, 152, 219, 0.7)';
            });
            
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: hourlyData.labels,
                    datasets: [{
                        label: 'شدة السلوك',
                        data: hourlyData.values,
                        backgroundColor: backgroundColors,
                        borderColor: 'rgba(52, 152, 219, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'النسبة المئوية للشدة'
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                }
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'الوقت خلال اليوم'
                            }
                        }
                    }
                }
            });
        }
        
        // عرض تأثير التغييرات
        function renderImpacts() {
            const impactContainer = document.getElementById('impactContainer');
            impactContainer.innerHTML = '';
            
            impacts.forEach(impact => {
                const div = document.createElement('div');
                div.className = 'impact-item';
                
                div.innerHTML = `
                    <div class="impact-label">${impact.label}</div>
                    <div class="impact-value ${impact.type}">${impact.value}</div>
                `;
                
                impactContainer.appendChild(div);
            });
        }
        
        // عرض مقارنة التدريب
        function renderTrainingComparison() {
            const trainingComparison = document.getElementById('trainingComparison');
            trainingComparison.innerHTML = '';
            
            trainingData.forEach(training => {
                const div = document.createElement('div');
                div.className = 'training-type';
                
                div.innerHTML = `
                    <h4>${training.type}</h4>
                    <div class="training-score">${training.score}%</div>
                `;
                
                trainingComparison.appendChild(div);
            });
        }
        
        // تحديث البيانات عشوائيًا لمحاكاة بيانات حية
        function refreshData() {
            // تحديث بيانات العدادات
            counters.forEach(counter => {
                // تغيير عشوائي بحدود ±5%
                const change = Math.floor(Math.random() * 11) - 5;
                counter.intensity = Math.max(50, Math.min(100, counter.intensity + change));
            });
            
            // تحديث بيانات الساعات
            hourlyData.values = hourlyData.values.map(value => {
                const change = Math.floor(Math.random() * 11) - 5;
                return Math.max(50, Math.min(100, value + change));
            });
            
            // تحديث بيانات التأثير
            impacts.forEach(impact => {
                if (impact.type === 'improvement') {
                    const currentValue = parseInt(impact.value);
                    const change = Math.floor(Math.random() * 6) - 2;
                    const newValue = Math.max(5, Math.min(40, currentValue + change));
                    impact.value = `+${newValue}%`;
                }
            });
            
            // تحديث بيانات التدريب
            trainingData.forEach(training => {
                const change = Math.floor(Math.random() * 9) - 4;
                training.score = Math.max(60, Math.min(100, training.score + change));
            });
            
            // إعادة عرض كل شيء
            renderCounters();
            renderHourlyChart();
            renderImpacts();
            renderTrainingComparison();
            
            // إشعار بالتحديث
            alert('تم تحديث البيانات بنجاح!');
        }
        
        // تصدير التقرير
        function exportReport() {
            // في تطبيق حقيقي، هنا سيكون هناك اتصال بالخادم لإنشاء ملف PDF
            // لكننا سنقوم بمحاكاة التصدير
            const reportData = {
                title: 'تقرير تحليل نقاط الألم الخفية',
                generatedAt: new Date().toLocaleString('ar-SA'),
                topCounters: counters.slice(0, 3),
                peakHours: hourlyData.labels[hourlyData.values.indexOf(Math.max(...hourlyData.values))],
                bestImpact: impacts.reduce((prev, current) => {
                    const prevValue = parseInt(prev.value);
                    const currentValue = parseInt(current.value);
                    return prevValue > currentValue ? prev : current;
                }),
                bestTraining: trainingData.reduce((prev, current) => 
                    prev.score > current.score ? prev : current
                )
            };
            
            const reportText = `
                ====================================
                تقرير تحليل نقاط الألم الخفية
                ====================================
                تم إنشاؤه في: ${reportData.generatedAt}
                
                العدادات الأعلى شدة:
                1. ${reportData.topCounters[0].name}: ${reportData.topCounters[0].intensity}%
                2. ${reportData.topCounters[1].name}: ${reportData.topCounters[1].intensity}%
                3. ${reportData.topCounters[2].name}: ${reportData.topCounters[2].intensity}%
                
                ساعة الذروة: ${reportData.peakHours}
                
                أكثر التدخلات تأثيراً: ${reportData.bestImpact.label} (${reportData.bestImpact.value})
                
                أفضل أنواع التدريب: ${reportData.bestTraining.type} (${reportData.bestTraining.score}%)
                
                ====================================
                التوصيات:
                1. التركيز على تحسين أداء العداد: ${reportData.topCounters[0].name}
                2. توزيع الحمل خلال ساعة الذروة (${reportData.peakHours})
                3. تعميم نجاح ${reportData.bestImpact.label} على مجالات أخرى
                4. توسيع نطاق ${reportData.bestTraining.type} ليشمل جميع الموظفين
            `;
            
            // محاكاة تنزيل الملف
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(reportText));
            element.setAttribute('download', 'تقرير_نقاط_الألم_الخفية.txt');
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
            
            alert('تم تصدير التقرير بنجاح!');
        }
    </script>
</body>
</html>